dist: xenial
language: node_js
cache: npm
branches:
    only:
        - master
env:
    global:
        - PR_BRANCH=$TRAVIS_PULL_REQUEST_BRANCH
        # Set arguments so lerna only runs scripts in changed packages
        - SCRIPT_ARGS=$(if [ "$PR_BRANCH" != "master" ]; then echo "--since $PR_BRANCH"; else echo ""; fi)
before_script:
    - echo $PR_BRANCH
    - echo $SCRIPT_ARGS
jobs:
    include:
        - name: "Lint"
          script: npm run lint -- $SCRIPT_ARGS
        - name: "Build"
          script: npm run build -- $SCRIPT_ARGS
        - name: "Unit tests"
          script: npm test -- $SCRIPT_ARGS
